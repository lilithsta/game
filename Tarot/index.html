<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>ä»Šæ—¥å¡”ç½—å åœ Tarot of the Day</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{background:radial-gradient(circle at center,#1a1b2f,#0d1321);color:#fff;
font-family:"Noto Sans SC","Noto Sans JP",sans-serif;text-align:center;margin:0;padding:0;transition:background 1s ease;}
h1{margin-top:40px;font-size:1.8em;text-shadow:0 0 10px #a29bfe;}
#langSelect{margin:10px;background:#00cec9;border:none;color:#fff;padding:8px 12px;border-radius:6px;cursor:pointer;}
#drawBtn{background:#6c5ce7;border:none;color:#fff;padding:12px 24px;border-radius:10px;cursor:pointer;font-size:16px;transition:all 0.3s;margin-top:20px;}
#drawBtn:hover{background:#a29bfe;}
.card{width:240px;height:420px;margin:40px auto;border-radius:10px;box-shadow:0 0 20px #6c5ce7;background-color:#2d3436;perspective:1000px;position:relative;}
.inner{width:100%;height:100%;transition:transform 0.8s;transform-style:preserve-3d;position:relative;}
.flip .inner{transform:rotateY(180deg);}
.front,.back{position:absolute;width:100%;height:100%;backface-visibility:hidden;border-radius:10px;}
.front{background-size:cover;background-position:center;}
.back{transform:rotateY(180deg);background:rgba(30,30,60,0.9);display:flex;flex-direction:column;justify-content:center;align-items:center;padding:15px;}
#cardName{font-size:1.2em;margin-bottom:10px;color:#ffd86b;}
#meaning{font-size:0.95em;line-height:1.4em;}
#fortuneBox{margin:20px auto;width:85%;max-width:500px;background:rgba(255,255,255,0.08);border-radius:12px;padding:15px;text-align:left;box-shadow:0 0 10px rgba(0,0,0,0.3);}
#fortuneBox h3{text-align:center;color:#ffd86b;}
.fortune-item{margin:6px 0;}
.stars{color:#ffd700;font-size:1.1em;}
footer{color:#aaa;font-size:0.8em;margin-bottom:20px;}
</style>
</head>
<body>

<h1>ğŸ”® ä»Šæ—¥å¡”ç½—å åœ Tarot of the Day</h1>
<select id="langSelect">
  <option value="zh">ä¸­æ–‡</option>
  <option value="en">English</option>
  <option value="jp">æ—¥æœ¬èª</option>
</select><br>
<button id="drawBtn">å¼€å§‹æŠ½ç‰Œ / Draw / ã‚«ãƒ¼ãƒ‰ã‚’å¼•ã</button>

<div class="card" id="tarotCard">
  <div class="inner">
    <div class="front" id="front"></div>
    <div class="back">
      <h2 id="cardName"></h2>
      <p id="meaning"></p>
    </div>
  </div>
</div>

<div id="fortuneBox" style="display:none;">
  <h3>ğŸŒŸ ä»Šæ—¥è¿åŠ¿æŠ¥å‘Š</h3>
  <div id="fortuneText"></div>
</div>

<footer>Â© 2025 ä»Šæ—¥å¡”ç½— Â· Tarot of the Day</footer>

<script>
document.addEventListener("DOMContentLoaded", async ()=>{
const elementsColor={m:"#5e4fa2",c:"#2e86de",w:"#ff8c42",s:"#b2bec3",p:"#55efc4"};
const btn=document.getElementById("drawBtn"),card=document.getElementById("tarotCard"),
inner=card.querySelector(".inner"),front=document.getElementById("front"),
cardName=document.getElementById("cardName"),meaning=document.getElementById("meaning"),
langSelect=document.getElementById("langSelect"),fortuneBox=document.getElementById("fortuneBox"),
fortuneText=document.getElementById("fortuneText");

// è½½å…¥JSON
let tarotDeck = [];
await fetch("tarotDeck.json")
  .then(res=>res.json())
  .then(data=>{
    tarotDeck = data;
    // æ·»åŠ å°é˜¿å°”å¡é‚£
    ["c","w","s","p"].forEach(suit=>{
      for(let i=1;i<=14;i++){
        tarotDeck.push({
          id:i,suit,
          name:{zh:`${{"c":"åœ£æ¯","w":"æƒæ–","s":"å®å‰‘","p":"é’±å¸"}[suit]}${i}`,
                en:`${{"c":"Cups","w":"Wands","s":"Swords","p":"Pentacles"}[suit]} ${i}`,
                jp:`${{"c":"ã‚«ãƒƒãƒ—","w":"ãƒ¯ãƒ³ãƒ‰","s":"ã‚½ãƒ¼ãƒ‰","p":"ãƒšãƒ³ã‚¿ã‚¯ãƒ«"}[suit]}ã®${i}`},
          meaning:{zh:{"c":"æƒ…æ„Ÿä¸å…³ç³»","w":"è¡ŒåŠ¨ä¸åˆ›é€ ","s":"æ€æƒ³ä¸çœŸç†","p":"ç‰©è´¨ä¸äº‹ä¸š"}[suit],
                   en:{"c":"Emotion & relationship","w":"Action & creativity","s":"Mind & truth","p":"Material & work"}[suit],
                   jp:{"c":"æ„Ÿæƒ…ã¨é–¢ä¿‚","w":"è¡Œå‹•ã¨å‰µé€ ","s":"æ€è€ƒã¨çœŸå®Ÿ","p":"ç‰©è³ªã¨ä»•äº‹"}[suit]}
        });
      }
    });
  })
  .catch(err=>alert("âŒ æ— æ³•åŠ è½½ tarotDeck.jsonï¼Œè¯·ç¡®è®¤æ–‡ä»¶å­˜åœ¨ã€‚"));

// å›¾ç‰‡è·¯å¾„
function getImgUrl(id,suit){const s=suit?suit.toLowerCase():"m";return `images/${s}${String(id).padStart(2,"0")}.jpg`;}

// ç”Ÿæˆä»Šæ—¥è¿åŠ¿
function randomStars(){return "â˜…".repeat(Math.floor(Math.random()*3+3));}
function genFortune(card,reversed,lang){
  const base={
    zh:{love:["æ„Ÿæƒ…ä¸Šéœ€çœŸè¯šæ²Ÿé€š","çˆ±æƒ…æœ‰æ–°æœºé‡","æ³¨æ„è¯¯ä¼šä¸å†·æ·¡","æµªæ¼«èƒ½é‡å¢å¼º"],
        career:["å·¥ä½œè¿›å±•é¡ºåˆ©","é€‚åˆå›¢é˜Ÿåˆä½œ","æ³¨æ„è®¡åˆ’ä¸è€å¿ƒ","æœ‰æ™‹å‡æœºä¼š"],
        health:["ä¿æŒè§„å¾‹ä½œæ¯","æ³¨æ„æƒ…ç»ªå‹åŠ›","ç²¾åŠ›å……æ²›","é¥®é£Ÿéœ€å‡è¡¡"],
        revHint:"é€†ä½ï¼šæš—ç¤ºå†…åœ¨çŸ›ç›¾æˆ–é˜»ç¢ï¼Œè¯·ä¿æŒå†·é™ã€‚",
        norHint:"æ­£ä½ï¼šèƒ½é‡æµåŠ¨é¡ºç•…ï¼Œä»£è¡¨ç§¯æå‰è¿›ã€‚"},
    en:{love:["Be honest in love.","New romantic chance.","Avoid misunderstandings.","Emotional energy flows strongly."],
        career:["Work goes well.","Good for teamwork.","Stay patient.","Chance for promotion."],
        health:["Keep a good routine.","Manage stress.","Energetic today.","Eat balanced meals."],
        revHint:"Reversed: Blockage or confusionâ€”stay calm.",
        norHint:"Upright: Energy flows positively."}
  }[lang]||base.zh;
  const pick=a=>a[Math.floor(Math.random()*a.length)];
  fortuneText.innerHTML=`
  <div class='fortune-item'>ğŸ’˜ çˆ±æƒ…ï¼š${pick(base.love)} <span class='stars'>${randomStars()}</span></div>
  <div class='fortune-item'>ğŸ’¼ äº‹ä¸šï¼š${pick(base.career)} <span class='stars'>${randomStars()}</span></div>
  <div class='fortune-item'>ğŸ’ª å¥åº·ï¼š${pick(base.health)} <span class='stars'>${randomStars()}</span></div>
  <hr style='opacity:0.3'>
  ğŸ“– <b>${card.name[lang]}</b>ï¼š${card.meaning[lang]}<br>
  ğŸ”„ ${reversed?base.revHint:base.norHint}`;
  fortuneBox.style.display="block";
}

// ç¼“å­˜
const todayKey=new Date().toISOString().slice(0,10);
let saved=JSON.parse(localStorage.getItem("tarot_today")||"null");
if(saved&&saved.date===todayKey){showCard(saved.card,saved.reversed,saved.lang,true);btn.textContent="ä»Šæ—¥å·²æŠ½ç‰Œï¼ˆç‚¹å‡»é‡æ–°æŸ¥çœ‹ï¼‰";}

// æŠ½ç‰Œé€»è¾‘
btn.addEventListener("click",()=>{
  const lang=langSelect.value;
  const stored=JSON.parse(localStorage.getItem("tarot_today")||"null");
  if(stored&&stored.date===todayKey){showCard(stored.card,stored.reversed,stored.lang,true);return;}
  const card=tarotDeck[Math.floor(Math.random()*tarotDeck.length)];
  const reversed=Math.random()<0.5;
  localStorage.setItem("tarot_today",JSON.stringify({date:todayKey,card,reversed,lang}));
  showCard(card,reversed,lang,false);
});

// æ˜¾ç¤ºå¡ç‰‡
function showCard(card,reversed,lang){
  const img=getImgUrl(card.id,card.suit);
  front.style.backgroundImage=`url('${img}')`;
  front.style.transform=reversed?"rotate(180deg)":"rotate(0)";
  cardName.textContent=card.name[lang]+(reversed?"ï¼ˆé€†ä½ï¼‰":"ï¼ˆæ­£ä½ï¼‰");
  meaning.textContent=(reversed?"ã€é€†ä½å«ä¹‰ã€‘":"ã€æ­£ä½å«ä¹‰ã€‘")+" "+card.meaning[lang];
  document.body.style.background=`radial-gradient(circle at center, ${elementsColor[card.suit]||"#6c5ce7"}, #0d1321)`;
  inner.classList.add("flip");
  genFortune(card,reversed,lang);
}
});
</script>
</body>
</html>
