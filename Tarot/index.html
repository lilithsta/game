<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>今日塔罗占卜 Tarot of the Day</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body {
    background: radial-gradient(circle at center, #1a1b2f, #0d1321);
    color: #fff;
    font-family: "Noto Sans SC", "Noto Sans JP", sans-serif;
    text-align: center;
    margin: 0;
    padding: 0;
  }
  h1 {
    margin-top: 40px;
    font-size: 1.8em;
    text-shadow: 0 0 10px #a29bfe;
  }
  #langSelect {
    margin: 10px;
    background: #00cec9;
    border: none;
    color: #fff;
    padding: 8px 12px;
    border-radius: 6px;
    cursor: pointer;
  }
  #drawBtn {
    background: #6c5ce7;
    border: none;
    color: #fff;
    padding: 12px 24px;
    border-radius: 10px;
    cursor: pointer;
    font-size: 16px;
    transition: all 0.3s;
    margin-top: 20px;
  }
  #drawBtn:hover { background: #a29bfe; }

  .card {
    width: 240px;
    height: 420px;
    margin: 40px auto;
    border-radius: 10px;
    box-shadow: 0 0 20px #6c5ce7;
    background-color: #2d3436;
    perspective: 1000px;
    position: relative;
  }
  .inner {
    width: 100%;
    height: 100%;
    transition: transform 0.8s;
    transform-style: preserve-3d;
    position: relative;
  }
  .flip .inner { transform: rotateY(180deg); }
  .front, .back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    border-radius: 10px;
  }
  .front {
    background-size: cover;
    background-position: center;
  }
  .back {
    transform: rotateY(180deg);
    background: rgba(30,30,60,0.9);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 15px;
  }
  #cardName { font-size: 1.2em; margin-bottom: 10px; color: #ffd86b; }
  #meaning { font-size: 0.95em; line-height: 1.4em; }
  footer { color: #aaa; font-size: 0.8em; margin-bottom: 20px; }
</style>
</head>
<body>

<h1>🔮 今日塔罗占卜 Tarot of the Day / 今日のタロット占い</h1>
<select id="langSelect">
  <option value="zh">中文</option>
  <option value="en">English</option>
  <option value="jp">日本語</option>
</select>
<br>
<button id="drawBtn">开始抽牌 / Draw / カードを引く</button>

<div class="card" id="tarotCard">
  <div class="inner">
    <div class="front" id="front"></div>
    <div class="back">
      <h2 id="cardName"></h2>
      <p id="meaning"></p>
    </div>
  </div>
</div>

<footer>© 2025 今日塔罗 · Tarot of the Day</footer>

<script>
/* --- 卡牌数据（部分示例，可扩展） --- */
const tarotDeck = [
  // 大阿尔卡那
  { id: 0, suit: "m", name: { zh: "愚者", en: "The Fool", jp: "愚者" }, meaning: { zh: "新的开始，自由与冒险。", en: "New beginnings, freedom, adventure.", jp: "新しい旅立ちと自由。" } },
  { id: 1, suit: "m", name: { zh: "魔术师", en: "The Magician", jp: "魔術師" }, meaning: { zh: "展现你的能力，创造与实现。", en: "Manifestation, power, creativity.", jp: "創造と意志の力。" } },
  { id: 19, suit: "m", name: { zh: "太阳", en: "The Sun", jp: "太陽" }, meaning: { zh: "成功、喜悦、幸福。", en: "Success, joy, happiness.", jp: "成功と幸福。" } },
  { id: 21, suit: "m", name: { zh: "世界", en: "The World", jp: "世界" }, meaning: { zh: "圆满、完成与成就。", en: "Fulfillment, completion, harmony.", jp: "完成と調和。" } },

  // 圣杯（C）
  { id: 1, suit: "C", name: { zh: "圣杯一", en: "Ace of Cups", jp: "カップのエース" }, meaning: { zh: "情感的新开始。", en: "New emotional beginnings.", jp: "新しい感情の始まり。" } },
  { id: 10, suit: "C", name: { zh: "圣杯十", en: "Ten of Cups", jp: "カップの10" }, meaning: { zh: "家庭幸福与和谐。", en: "Harmony and joy in relationships.", jp: "家庭の調和と幸福。" } },

  // 权杖（W）
  { id: 1, suit: "w", name: { zh: "权杖一", en: "Ace of Wands", jp: "ワンドのエース" }, meaning: { zh: "灵感的火花。", en: "The spark of inspiration.", jp: "ひらめきの火花。" } },

  // 宝剑（S）
  { id: 1, suit: "s", name: { zh: "宝剑一", en: "Ace of Swords", jp: "ソードのエース" }, meaning: { zh: "新的想法与真理。", en: "New ideas and clarity.", jp: "新しい考えと真実。" } },

  // 钱币（P）
  { id: 1, suit: "p", name: { zh: "钱币一", en: "Ace of Pentacles", jp: "ペンタクルのエース" }, meaning: { zh: "新的物质机遇。", en: "New material opportunities.", jp: "新しい物質的チャンス。" } }
];

/* --- 元素引用 --- */
const btn = document.getElementById("drawBtn");
const card = document.getElementById("tarotCard");
const inner = card.querySelector(".inner");
const front = document.getElementById("front");
const cardName = document.getElementById("cardName");
const meaning = document.getElementById("meaning");
const langSelect = document.getElementById("langSelect");

/* --- 根据花色和编号构建图像路径 --- */
function getImgUrl(id, suit) {
  const prefix = suit.toUpperCase();
  const num = String(id).padStart(2, '0');
  return `https://raw.githubusercontent.com/lambiengcode/flutter-tarot-card/master/images/${prefix}${num}.png`;
}

/* --- 加载保存的今日抽牌 --- */
const todayKey = new Date().toISOString().slice(0,10);
let saved = JSON.parse(localStorage.getItem("tarot_today"));
if (saved && saved.date === todayKey) {
  showCard(saved.card, saved.reversed, saved.lang, true);
  btn.textContent = "今日已抽牌（点击重新查看）";
}

/* --- 抽卡逻辑 --- */
btn.addEventListener("click", () => {
  const lang = langSelect.value;
  const todayKey = new Date().toISOString().slice(0,10);
  let stored = JSON.parse(localStorage.getItem("tarot_today"));
  if (stored && stored.date === todayKey) {
    showCard(stored.card, stored.reversed, stored.lang, true);
    return;
  }
  const cardData = tarotDeck[Math.floor(Math.random() * tarotDeck.length)];
  const reversed = Math.random() < 0.5;
  localStorage.setItem("tarot_today", JSON.stringify({ date: todayKey, card: cardData, reversed, lang }));
  showCard(cardData, reversed, lang, false);
});

/* --- 显示卡牌 --- */
function showCard(cardData, reversed, lang, instant) {
  const imgUrl = getImgUrl(cardData.id, cardData.suit);
  front.style.backgroundImage = `url('${imgUrl}')`;
  front.style.transform = reversed ? "rotate(180deg)" : "rotate(0)";
  cardName.textContent = cardData.name[lang] + (reversed ? "（逆位）" : "（正位）");
  meaning.textContent = (reversed ? "【逆位含义】" : "【正位含义】") + " " + cardData.meaning[lang];
  inner.classList.add("flip");
}
</script>

</body>
</html>
